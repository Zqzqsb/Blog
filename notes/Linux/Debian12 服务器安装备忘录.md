---
title: Debian12 æœåŠ¡å™¨å®‰è£…å¤‡å¿˜å½•
createTime: 2024-5-27
author: ZQ
tags:
  - linux
  - å¤‡å¿˜å½•
description: æœ¬æ–‡è®°å½•debian12ä½œä¸ºæœåŠ¡å™¨çš„å®‰è£…å’Œé…ç½®è¿‡ç¨‹
permalink: /debian_server/
---
<br> æœ¬æ–‡è®°å½•debian12ä½œä¸ºæœåŠ¡å™¨çš„å®‰è£…å’Œé…ç½®è¿‡ç¨‹
<!-- more -->

## å‰è¨€

æœ¬æ–‡è®°å½•è‡ªç”¨çš„debianæœåŠ¡å™¨çš„å®‰è£…å’Œé…ç½®è¿‡ç¨‹ã€‚æœåŠ¡å™¨çš„ç¡¬ä»¶é…ç½®å¦‚ä¸‹ã€‚

| ç±»åˆ«           | å‹å·                  |
| ------------ | ------------------- |
| CPU          | 12700k              |
| Mother Board | z690                |
| DRAM         | DDR4 16G * 2        |
| System Drive | 970EVO 512G PCIE3.0 |
| Data Drive   | Gloway 4TB PCIE4.0  |
| BackUp Drive | æ—¥ç«‹ 10TB * 2         |
| CASE         | åŠå²›é“ç›’ F20            |
| Power Supply | åˆ©æ°‘TG1000 1000w      |

## ç†Ÿæ‚‰å‘½ä»¤

### `fdisk`

> `fdisk`Â æ˜¯ Linux ç³»ç»Ÿä¸Šä¸€ä¸ªå¸¸ç”¨çš„ç£ç›˜åˆ†åŒºå·¥å…·ã€‚å®ƒå¯ä»¥ç”¨æ¥æŸ¥çœ‹ã€åˆ›å»ºã€åˆ é™¤å’Œä¿®æ”¹ç£ç›˜åˆ†åŒºã€‚è¯¥å‘½ä»¤éœ€è¦åœ¨sudoæƒé™ä¸‹æ‰§è¡Œã€‚

1. åˆ—å‡ºç£ç›˜åˆ†åŒºä¿¡æ¯ `sudo fdisk -l`
2. è¿›å…¥äº¤äº’å¼åˆ†åŒºç¼–è¾‘æ¨¡å¼ ä¸ºç‰¹å®šè®¾å¤‡åˆ†åŒº `sudo fdisk [dev/device_name]`

### `parted`

> `parted`Â æ˜¯ Linux ç³»ç»Ÿä¸Šä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”æ›´åŠ ç”¨æˆ·å‹å¥½çš„ç£ç›˜åˆ†åŒºå·¥å…·,å®ƒæ˜¯å¯¹ä¼ ç»ŸÂ `fdisk`Â å‘½ä»¤çš„ä¸€ç§è¡¥å……å’Œå‡çº§ã€‚ä¸Â `fdisk`Â ç›¸æ¯”,`parted`Â å…·æœ‰ä»¥ä¸‹ä¸€äº›ä¼˜åŠ¿:

1. **æ”¯æŒæ›´å¤§ç£ç›˜**:Â `parted`Â å¯ä»¥å¤„ç†è¶…è¿‡ 2TB çš„å¤§å®¹é‡ç£ç›˜,è€ŒÂ `fdisk`Â å¯¹ç£ç›˜å®¹é‡æœ‰ä¸€å®šé™åˆ¶ã€‚
2. **æ”¯æŒæ›´å¤šæ–‡ä»¶ç³»ç»Ÿ**:Â `parted`Â æ”¯æŒå¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹,å¦‚ `ext4`ã€`btrfs`ã€`XFS` ç­‰,è€ŒÂ `fdisk`Â åªèƒ½è¯†åˆ«åŸºæœ¬çš„ DOS åˆ†åŒºè¡¨ã€‚
3. **æ›´å‹å¥½çš„äº¤äº’ç•Œé¢**:Â `parted`Â æä¾›äº†æ›´åŠ äººæ€§åŒ–çš„äº¤äº’ç•Œé¢,ä½¿ç”¨èµ·æ¥æ›´åŠ ç›´è§‚å’Œæ–¹ä¾¿ã€‚
4. **æ”¯æŒåŠ¨æ€è°ƒæ•´åˆ†åŒº**:Â `parted`Â æ”¯æŒåœ¨ä¸é‡å¯ç³»ç»Ÿçš„æƒ…å†µä¸‹åŠ¨æ€è°ƒæ•´ç£ç›˜åˆ†åŒºçš„å¤§å°å’Œä½ç½®ã€‚è¿™åœ¨æ‰©å®¹æˆ–é‡æ–°è§„åˆ’ç£ç›˜æ—¶éå¸¸æœ‰ç”¨ã€‚
5. **æ›´å¥½çš„é”™è¯¯å¤„ç†**:Â `parted`Â ä¼šåœ¨æ‰§è¡Œå±é™©æ“ä½œæ—¶æç¤ºç”¨æˆ·ç¡®è®¤,å¹¶ä¼šå°½é‡é¿å…é€ æˆæ•°æ®ä¸¢å¤±ã€‚

è¯¥å‘½ä»¤çš„ä½¿ç”¨æ–¹å¼å’Œfdiskç±»ä¼¼

1. åˆ—å‡ºç£ç›˜åˆ†åŒºä¿¡æ¯ `sudo parted -l`
2. è¿›å…¥äº¤äº’å¼åˆ†åŒºç¼–è¾‘æ¨¡å¼ ä¸ºç‰¹å®šè®¾å¤‡åˆ†åŒº `sudo parted [dev/device_name]`

### `mdadm`

>`mdadm`Â æ˜¯ Linux ç³»ç»Ÿä¸Šç”¨äºç®¡ç†è½¯ä»¶ RAID çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ã€‚å®ƒå…è®¸ç”¨æˆ·åˆ›å»ºã€ç›‘æ§å’Œç®¡ç†å„ç§ç±»å‹çš„ RAID é˜µåˆ—,åŒ…æ‹¬ RAID 0ã€RAID 1ã€RAID 5ã€RAID 6 ç­‰ã€‚

1. åˆ›å»ºRAIDé˜µåˆ—,ä¾‹å­ä¸ºä¸€ä¸ªRAID5é˜µåˆ— åŒ…å››ä¸ªå—è®¾å¤‡ é˜µåˆ—ä¼šè¡¨ç°ä¸ºä¸€ä¸ªç»Ÿä¸€çš„å—è®¾å¤‡md0

```shell
sudo mdadm --create /dev/md0 --level=5 --raid-devices=4 /dev/sdb1 /dev/sdc1 /dev/sdd1 /dev/sde1
```

2. æŸ¥çœ‹RAIDé˜µåˆ—çŠ¶æ€

```shell
sudo mdadm --detail /dev/md0
```

3. æ‰©å±•RAIDé˜µåˆ—ï¼ŒRAID5ï¼ŒRAID6æ”¯æŒçƒ­æ‰©å±•

```shell
sudo mdadm --grow /dev/md0 --raid-devices=5
```

4. ä»RAIDé˜µåˆ—ä¸­ç§»å‡ºè®¾å¤‡

```shell
sudo mdadm --remove /dev/md0 /dev/sde1
```

5. æ·»åŠ çƒ­å¤‡ä»½è®¾å¤‡ï¼Œçƒ­å¤‡è®¾å¤‡æ˜¯åº”å¯¹æ•´åˆ—æ•…éšœçš„é¢„å¤‡å—è®¾å¤‡ï¼Œä¼šè‡ªåŠ¨æ›¿æ¢æ•…éšœè®¾å¤‡

```shell
sudo mdadm --add /dev/md0 /dev/sdf1
```

6. å®šæœŸç›‘æ§RAIDé˜µåˆ—,å¹¶å‘é€é‚®ä»¶

```shell
sudo mdadm --monitor --scan --mail=your@email.com
```

7. é‡æ–°ç»„è£…ä¸€ä¸ªä¹‹å‰åˆ›å»ºçš„RAIDé˜µåˆ—

```shell
sudo mdadm --assemble /dev/md0 /dev/sdb1 /dev/sdc1 /dev/sdd1 /dev/sde1
```

### `lsblk`

> `lsblk`Â æ˜¯ Linux ç³»ç»Ÿä¸Šä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å—è®¾å¤‡åˆ—è¡¨æŸ¥çœ‹å‘½ä»¤ã€‚å®ƒèƒ½å¿«é€Ÿã€ç›´è§‚åœ°æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰å—è®¾å¤‡çš„æ‹“æ‰‘ç»“æ„å’Œå±æ€§ä¿¡æ¯ã€‚

```shell
âœ  ~ lsblk
NAME        MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINTS
sda           8:0    0   9.1T  0 disk
â””â”€sda1        8:1    0   9.1T  0 part
  â””â”€md0       9:0    0   9.1T  0 raid1 /hdd
sdb           8:16   0   9.1T  0 disk
â””â”€sdb1        8:17   0   9.1T  0 part
  â””â”€md0       9:0    0   9.1T  0 raid1 /hdd
nvme1n1     259:0    0 465.8G  0 disk
â”œâ”€nvme1n1p1 259:1    0   512M  0 part  /boot/efi
â”œâ”€nvme1n1p2 259:2    0 464.3G  0 part  /
â””â”€nvme1n1p3 259:3    0   976M  0 part  [SWAP]
nvme0n1     259:4    0   3.7T  0 disk
â””â”€nvme0n1p1 259:5    0   3.7T  0 part  /data
```

### `mkfs`

>`mkfs`å‘½ä»¤æ˜¯Linuxå’ŒUnixç³»ç»Ÿä¸­ç”¨äºåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿçš„å‘½ä»¤ã€‚å®ƒçš„å…¨ç§°æ˜¯"make file system"ã€‚

1. **åŸºæœ¬ç”¨æ³•**:
    - `mkfs [options] device`ï¼šåœ¨æŒ‡å®šè®¾å¤‡ä¸Šåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿã€‚
2. **å¸¸ç”¨é€‰é¡¹**:
    - `-t`ï¼šæŒ‡å®šè¦åˆ›å»ºçš„æ–‡ä»¶ç³»ç»Ÿç±»å‹,å¦‚ext4ã€xfsã€btrfsç­‰ã€‚
    - `-b`ï¼šæŒ‡å®šæ–‡ä»¶ç³»ç»Ÿå—å¤§å°ã€‚
    - `-i`ï¼šæŒ‡å®šæ¯ä¸ªinodeçš„å­—èŠ‚æ•°ã€‚
    - `-L`ï¼šæŒ‡å®šæ–‡ä»¶ç³»ç»Ÿå·æ ‡ã€‚
    - `-m`ï¼šæŒ‡å®šä¿ç•™ç»™rootç”¨æˆ·çš„ç©ºé—´ç™¾åˆ†æ¯”ã€‚
    - `-c`ï¼šåœ¨åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿå‰æ£€æŸ¥è®¾å¤‡æ˜¯å¦æœ‰åå—ã€‚
3. **åˆ›å»ºä¸åŒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿ**:
    - `mkfs -t ext4 /dev/sdb1`ï¼šåˆ›å»ºext4æ–‡ä»¶ç³»ç»Ÿã€‚
    - `mkfs -t xfs /dev/sdc1`ï¼šåˆ›å»ºXFSæ–‡ä»¶ç³»ç»Ÿã€‚
    - `mkfs -t btrfs /dev/sdd1`ï¼šåˆ›å»ºbtrfsæ–‡ä»¶ç³»ç»Ÿã€‚
4. **æ³¨æ„äº‹é¡¹**:
    - æ‰§è¡Œ`mkfs`å‘½ä»¤ä¼šå½»åº•æ ¼å¼åŒ–æŒ‡å®šè®¾å¤‡,å°†ç°æœ‰æ•°æ®å…¨éƒ¨åˆ é™¤,è¯·è°¨æ…æ“ä½œã€‚
    - ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿæœ‰ä¸åŒçš„ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯,è¯·æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€‚
    - æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºå®Œæˆå,è¿˜éœ€è¦å°†å…¶æŒ‚è½½åˆ°ç›¸åº”çš„æŒ‚è½½ç‚¹æ‰èƒ½ä½¿ç”¨ã€‚

### `mount`

> `mount`å‘½ä»¤ç”¨äºåœ¨Linuxç³»ç»Ÿä¸­æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿã€‚

1. **åŸºæœ¬è¯­æ³•**:
    - `mount [-t type] [-o options] device directory`
2. **å¸¸ç”¨é€‰é¡¹**:
    - `-t type`: æŒ‡å®šè¦æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹,å¦‚ext4ã€xfsã€nfsç­‰ã€‚
    - `-o options`: æŒ‡å®šæŒ‚è½½é€‰é¡¹,å¦‚ro(åªè¯»)ã€rw(è¯»å†™)ã€async(å¼‚æ­¥)ç­‰ã€‚å¤šä¸ªé€‰é¡¹ç”¨é€—å·åˆ†éš”ã€‚
    - `-a`: æŒ‚è½½/etc/fstabä¸­åˆ—å‡ºçš„æ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿã€‚
    - `-L label`: é€šè¿‡æ–‡ä»¶ç³»ç»Ÿå·æ ‡æŒ‚è½½ã€‚
    - `-U uuid`: é€šè¿‡æ–‡ä»¶ç³»ç»ŸUUIDæŒ‚è½½ã€‚
3. **æŒ‚è½½ç¤ºä¾‹**:
    - `mount /dev/sdb1 /mnt`: å°†/dev/sdb1è®¾å¤‡æŒ‚è½½åˆ°/mntç›®å½•ã€‚
    - `mount -t ext4 /dev/sdc1 /data`: å°†ext4æ–‡ä»¶ç³»ç»Ÿ/dev/sdc1æŒ‚è½½åˆ°/dataç›®å½•ã€‚
    - `mount -t nfs 192.168.1.100:/share /mnt/nfs`: å°†NFSå…±äº«ç›®å½•æŒ‚è½½åˆ°/mnt/nfsã€‚
    - `mount -o ro /dev/sdb1 /media`: ä»¥åªè¯»æ–¹å¼æŒ‚è½½/dev/sdb1åˆ°/mediaç›®å½•ã€‚
### `df`

>`df`å‘½ä»¤æ˜¯Linuxå’ŒUnixç³»ç»Ÿä¸­ç”¨äºæ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µçš„å¸¸ç”¨å‘½ä»¤ã€‚

1. **åŸºæœ¬ç”¨æ³•**:
    - `df`ï¼šæ˜¾ç¤ºæ‰€æœ‰å·²æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ä½¿ç”¨æƒ…å†µã€‚
2. **é€‰é¡¹**:
    - `-h`ï¼šä»¥äººç±»å¯è¯»çš„æ–¹å¼æ˜¾ç¤ºç£ç›˜ç©ºé—´å¤§å°,å¦‚MBã€GBç­‰ã€‚
    - `-i`ï¼šæ˜¾ç¤ºinodeä½¿ç”¨æƒ…å†µè€Œä¸æ˜¯ç£ç›˜ç©ºé—´ã€‚
    - `-T`ï¼šæ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿç±»å‹ã€‚
    - `-t`ï¼šåªæ˜¾ç¤ºæŒ‡å®šç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚
    - `-x`ï¼šæ’é™¤æŒ‡å®šç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚
3. **æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿæˆ–è·¯å¾„**:
    - `df /home`ï¼šåªæ˜¾ç¤ºåŒ…å«/homeç›®å½•çš„æ–‡ä»¶ç³»ç»Ÿã€‚
    - `df /dev/sda1`ï¼šæ˜¾ç¤ºæŒ‡å®šè®¾å¤‡çš„æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯ã€‚
4. **å…¶ä»–ç”¨æ³•**:
    - `df -h`ï¼šä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µã€‚
    - `df -i`ï¼šæ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿinodeä½¿ç”¨æƒ…å†µã€‚
    - `df -Th`ï¼šæ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿç±»å‹å’Œäººç±»å¯è¯»çš„ç£ç›˜ç©ºé—´ä¿¡æ¯ã€‚
    - `df -x tmpfs`ï¼šæ’é™¤tmpfsç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚
5. **è¾“å‡ºè§£é‡Š**:
    - **Filesystem**ï¼šæ–‡ä»¶ç³»ç»Ÿåç§°æˆ–è®¾å¤‡åç§°ã€‚
    - **1K-blocks**ï¼šæ€»ç£ç›˜å®¹é‡,å•ä½ä¸º1KBå—ã€‚
    - **Used**ï¼šå·²ä½¿ç”¨å®¹é‡ã€‚
    - **Available**ï¼šå¯ç”¨å®¹é‡ã€‚
    - **Use%**ï¼šå·²ä½¿ç”¨å®¹é‡çš„ç™¾åˆ†æ¯”ã€‚
    - **Mounted on**ï¼šæ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹ã€‚

### `du`

> `du`å‘½ä»¤æ˜¯Linuxç³»ç»Ÿä¸­ç”¨äºä¼°è®¡æ–‡ä»¶æˆ–ç›®å½•å ç”¨ç£ç›˜ç©ºé—´å¤§å°çš„å·¥å…·ã€‚

1. **æŸ¥çœ‹ç›®å½•æˆ–æ–‡ä»¶å ç”¨ç©ºé—´**
    - `du path`: æ˜¾ç¤ºæŒ‡å®šç›®å½•æˆ–æ–‡ä»¶çš„ç£ç›˜ä½¿ç”¨æƒ…å†µã€‚
    - `du -h path`: ä»¥äººç±»å¯è¯»çš„æ ¼å¼(KBã€MBã€GBç­‰)æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µã€‚
2. **é€’å½’ç»Ÿè®¡ç›®å½•å¤§å°**
    - `du -s path`: åªæ˜¾ç¤ºæŒ‡å®šç›®å½•çš„æ€»ä½¿ç”¨ç©ºé—´,ä¸æ˜¾ç¤ºå­ç›®å½•ã€‚
    - `du -a path`: æ˜¾ç¤ºæŒ‡å®šç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶çš„ä½¿ç”¨ç©ºé—´ã€‚
    - `du -d n path`: ä»…æ˜¾ç¤ºåµŒå¥—å±‚æ•°ä¸è¶…è¿‡nå±‚çš„ç›®å½•ä½¿ç”¨æƒ…å†µã€‚
3. **æ’åºè¾“å‡ºç»“æœ**
    - `du -h | sort -h`: æŒ‰ç…§äººç±»å¯è¯»çš„æ ¼å¼å¯¹ç»“æœè¿›è¡Œæ’åºã€‚
    - `du | sort -n`: æŒ‰ç…§å­—èŠ‚æ•°å¤§å°å¯¹ç»“æœè¿›è¡Œæ’åºã€‚
4. **æ’é™¤ç‰¹å®šç›®å½•æˆ–æ–‡ä»¶**
    - `du --exclude=pattern path`: æ’é™¤åŒ¹é…æŒ‡å®šæ¨¡å¼çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚
    - `du --max-depth=n path`: ä»…ç»Ÿè®¡æŒ‡å®šç›®å½•åŠå…¶nå±‚å­ç›®å½•ã€‚
5. **æ€»ç»“ç£ç›˜ä½¿ç”¨æƒ…å†µ**
    - `du -c`: åœ¨è¾“å‡ºç»“æœçš„æœ€åæ˜¾ç¤ºæ€»çš„ç£ç›˜ä½¿ç”¨é‡ã€‚
    - `du -s /`: æ˜¾ç¤ºæ•´ä¸ªæ ¹ç›®å½•çš„ç£ç›˜ä½¿ç”¨æƒ…å†µã€‚
6. **ç»“åˆç®¡é“ä½¿ç”¨**
    - `du path | sort -n | head -n 5`: åˆ—å‡ºæŒ‡å®šç›®å½•ä¸‹å ç”¨ç©ºé—´æœ€å¤§çš„å‰5ä¸ªå­ç›®å½•ã€‚
    - `du -ak / | sort -n | tail -n 1`: æ˜¾ç¤ºæ ¹ç›®å½•ä¸‹å ç”¨ç©ºé—´æœ€å¤§çš„å•ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å¤§å°ã€‚

## ç›¸å…³çŸ¥è¯†

### `UUID`

> UUIDï¼ˆUniversally Unique Identifierï¼‰æ˜¯ä¸€ç§æ ‡è¯†ç¬¦,ç”¨äºåœ¨åˆ†å¸ƒå¼è®¡ç®—ç¯å¢ƒä¸­å”¯ä¸€åœ°æ ‡è¯†ä¿¡æ¯ã€‚å®ƒçš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬:

1. **å”¯ä¸€æ€§**ï¼šUUIDè¢«è®¾è®¡æˆåœ¨å…¨çƒèŒƒå›´å†…æ˜¯å”¯ä¸€çš„ã€‚é€šè¿‡ä½¿ç”¨è¶³å¤Ÿé•¿çš„æ ‡è¯†ç¬¦(128ä½)ä»¥åŠéšæœºå’Œä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•,å¯ä»¥ç¡®ä¿ä¸ä¼šå‡ºç°é‡å¤çš„UUIDã€‚
2. **åˆ†æ•£æ€§**ï¼šUUIDä¸éœ€è¦é›†ä¸­çš„æ³¨å†Œæœºæ„å³å¯ç”Ÿæˆã€‚ä»»ä½•ä¸ªä½“æˆ–ç»„ç»‡éƒ½å¯ä»¥ç‹¬ç«‹åœ°ç”Ÿæˆè‡ªå·±çš„UUID,è€Œä¸ä¼šä¸ä»–äººçš„UUIDå†²çªã€‚
3. **å¯è¯»æ€§å·®**ï¼šUUIDç”±32ä¸ª16è¿›åˆ¶å­—ç¬¦ç»„æˆ,é€šå¸¸ä»¥è¿å­—ç¬¦åˆ†éš”æˆ8-4-4-4-12çš„æ ¼å¼æ˜¾ç¤º,ä¾‹å¦‚"550e8400-e29b-41d4-a716-446655440000"ã€‚è¿™ç§å½¢å¼ä¸å¤ªä¾¿äºäººå·¥è¯†åˆ«å’Œè®°å¿†ã€‚
4. **åº”ç”¨å¹¿æ³›**ï¼šUUIDå¹¿æ³›åº”ç”¨äºè®¡ç®—æœºè½¯ä»¶ä¸­,å°¤å…¶æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿã€æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿç­‰é¢†åŸŸ,ç”¨äºæ ‡è¯†å„ç§å¯¹è±¡,å¦‚æ–‡ä»¶ã€è®¾å¤‡ã€ç”¨æˆ·å¸æˆ·ç­‰ã€‚

å½“ä½ åœ¨ä¸€ä¸ªå­˜å‚¨è®¾å¤‡ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†åŒºå¹¶æ ¼å¼åŒ–ä¸ºæŸç§æ–‡ä»¶ç³»ç»Ÿï¼ˆä¾‹å¦‚ext4ã€xfsç­‰ï¼‰çš„æ—¶å€™ï¼Œæ–‡ä»¶ç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªUUIDã€‚è¿™ä¸ªUUIDæ˜¯åœ¨æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºçš„è¿‡ç¨‹ä¸­éšæœºç”Ÿæˆçš„ï¼Œå› æ­¤å³ä½¿ä½ åœ¨ç›¸åŒçš„è®¾å¤‡ä¸Šåˆ›å»ºç›¸åŒå¤§å°ã€ç›¸åŒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒä»¬çš„UUIDä¹Ÿä¼šä¸åŒã€‚

UUIDçš„ä¸»è¦ä½œç”¨æ˜¯æä¾›ä¸€ä¸ªåœ¨å…¨å±€èŒƒå›´å†…å”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œç”¨äºå”¯ä¸€åœ°æ ‡è¯†ä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶ç³»ç»Ÿï¼Œè¿™æ ·å³ä½¿å­˜å‚¨è®¾å¤‡çš„è®¾å¤‡åï¼ˆä¾‹å¦‚/dev/sda1ã€/dev/sdb2ç­‰ï¼‰æ”¹å˜ï¼Œç³»ç»Ÿä¹Ÿèƒ½é€šè¿‡UUIDæ‰¾åˆ°æ­£ç¡®çš„è®¾å¤‡ã€‚

### `fstab`

`/etc/fstab`ç”¨äºå®ç°ç³»ç»Ÿå¯åŠ¨æ—¶çš„è‡ªåŠ¨æŒ‚è½½ã€‚

```shell
<è®¾å¤‡>    <æŒ‚è½½ç‚¹>    <æ–‡ä»¶ç³»ç»Ÿç±»å‹>     <æŒ‚è½½å‚æ•°>    <è½¬å‚¨é¢‘ç‡>    <è‡ªæ£€é¡ºåº>
/dev/sda1  /          ext4            defaults    0            1
/dev/sda2  /home      ext4            defaults    0            2
/dev/md0   /data      xfs             defaults    0            0
192.168.1.100:/share  /mnt/nfs  nfs   defaults    0            0
```

> å…¶ä¸­å„å­—æ®µçš„å«ä¹‰å¦‚ä¸‹:

1. `<è®¾å¤‡>`: è¿™å¯ä»¥æ˜¯è®¾å¤‡åã€UUIDï¼ˆé€šç”¨å”¯ä¸€è¯†åˆ«ç ï¼‰ã€LABELï¼ˆæ ‡ç­¾ï¼‰æˆ–è€…PARTUUIDï¼ˆåˆ†åŒºçš„UUIDï¼‰ã€‚
2. `<æŒ‚è½½ç‚¹>`: è¦æŒ‚è½½åˆ°çš„ç›®å½•,å¿…é¡»äº‹å…ˆåˆ›å»ºå¥½ã€‚
3. `<æ–‡ä»¶ç³»ç»Ÿç±»å‹>`: å¦‚ext4ã€xfsã€nfsç­‰ã€‚
4. `<æŒ‚è½½å‚æ•°>`: æŒ‚è½½æ—¶ä½¿ç”¨çš„å¯é€‰å‚æ•°,å¦‚`defaults`ã€`noatime`ã€`rw`ç­‰ã€‚
5. `<è½¬å‚¨é¢‘ç‡>`: 0è¡¨ç¤ºä¸å¤‡ä»½,1è¡¨ç¤ºæ¯å¤©å¤‡ä»½,2è¡¨ç¤ºéš”å¤©å¤‡ä»½ã€‚
6. `<è‡ªæ£€é¡ºåº>`: 0è¡¨ç¤ºä¸è‡ªæ£€,1è¡¨ç¤ºç¬¬ä¸€ä¸ªè‡ªæ£€,2è¡¨ç¤ºç¬¬äºŒä¸ªè‡ªæ£€,ä»¥æ­¤ç±»æ¨ã€‚

è¦å®ç°è‡ªåŠ¨æŒ‚è½½,åªéœ€åœ¨`/etc/fstab`ä¸­æ·»åŠ ç›¸åº”çš„æ¡ç›®å³å¯ã€‚æŒ‚è½½ç‚¹å¿…é¡»äº‹å…ˆåˆ›å»ºå¥½,æ–‡ä»¶ç³»ç»Ÿç±»å‹å’ŒæŒ‚è½½å‚æ•°è¦æ ¹æ®å®é™…æƒ…å†µè®¾ç½®ã€‚

ä¿®æ”¹`/etc/fstab`æ–‡ä»¶å,å¯ä»¥ä½¿ç”¨`mount -a`å‘½ä»¤ç«‹å³ç”Ÿæ•ˆ,æˆ–è€…é‡æ–°å¯åŠ¨ç³»ç»Ÿè®©é…ç½®ç”Ÿæ•ˆã€‚

### `btrfs`

>btrfsæ˜¯ä¸€ç§æ–°å‹çš„Linuxæ–‡ä»¶ç³»ç»Ÿ,å®ƒæä¾›äº†è®¸å¤šå…ˆè¿›çš„åŠŸèƒ½å’Œç‰¹æ€§,åŒ…æ‹¬:

1. **å†™æ—¶å¤åˆ¶(COW)**: btrfsé‡‡ç”¨å†™æ—¶å¤åˆ¶æœºåˆ¶,å¯ä»¥å¿«é€Ÿåˆ›å»ºå¿«ç…§å’Œå‰¯æœ¬,è€Œä¸å ç”¨é¢å¤–çš„ç£ç›˜ç©ºé—´ã€‚è¿™å¯¹å¤‡ä»½å’Œæ•°æ®æ¢å¤å¾ˆæœ‰å¸®åŠ©ã€‚
2. **å­å·å’Œå¿«ç…§**: btrfsæ”¯æŒåˆ›å»ºå­å·,å¯ä»¥ä½œä¸ºç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œç®¡ç†ã€‚å¿«ç…§åŠŸèƒ½å¯ä»¥å¿«é€Ÿè®°å½•å­å·çš„çŠ¶æ€ã€‚
3. **RAIDæ”¯æŒ**: btrfså†…ç½®RAIDåŠŸèƒ½,å¯ä»¥å®ç°æ•°æ®çš„å†—ä½™å’Œå®¹é”™ã€‚æ”¯æŒå¤šè®¾å¤‡RAID0ã€RAID1ã€RAID10ç­‰æ¨¡å¼ã€‚
4. **å‹ç¼©**: btrfsæ”¯æŒé€æ˜çš„åœ¨çº¿å‹ç¼©,å¯ä»¥é™ä½å­˜å‚¨ç©ºé—´çš„ä½¿ç”¨ã€‚
5. **è‡ªåŠ¨ç¢ç‰‡æ•´ç†**: btrfså…·æœ‰è‡ªåŠ¨ç¢ç‰‡æ•´ç†åŠŸèƒ½,å¯ä»¥æœ€å°åŒ–ç£ç›˜ç¢ç‰‡ã€‚
6. **æ ¡éªŒå’Œ**: btrfsä¼šå¯¹æ•°æ®å’Œå…ƒæ•°æ®è®¡ç®—æ ¡éªŒå’Œ,å¯ä»¥å‘ç°å¹¶ä¿®å¤æ•°æ®æŸåã€‚
7. **åœ¨çº¿æ‰©å®¹å’Œç¼©å®¹**: btrfsæ”¯æŒåœ¨çº¿æ‰©å®¹å’Œç¼©å®¹,å¯ä»¥åŠ¨æ€è°ƒæ•´æ–‡ä»¶ç³»ç»Ÿå¤§å°ã€‚
8. **äº‹åŠ¡æ€§æ“ä½œ**: btrfsæ”¯æŒäº‹åŠ¡æ€§æ“ä½œ,å¯ä»¥ç¡®ä¿å…ƒæ•°æ®çš„ä¸€è‡´æ€§ã€‚

éšç€æ—¶é—´çš„æ¨ç§»,å®ƒä¹Ÿå¿…å°†æˆä¸ºæ›´å¤šLinuxå‘è¡Œç‰ˆçš„é»˜è®¤é€‰æ‹©ã€‚

- åœ¨Debianä¸­,btrfs-toolsè½¯ä»¶åŒ…æä¾›äº†ç®¡ç†btrfsæ–‡ä»¶ç³»ç»Ÿçš„å‘½ä»¤è¡Œå·¥å…·ã€‚
- å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…:

```shell
sudo apt-get install btrfs-tools
```


##  Pipeline

### 1. ææ–™å‡†å¤‡

+  å­˜å‚¨`debian12` ç³»ç»Ÿisoçš„uç›˜

### 2. ä¿®æ”¹`UEFI`å¯åŠ¨

+ è¿›å…¥`BIOS`å¹¶ä¿®æ”¹å¯åŠ¨æ–¹å¼ï¼Œå°†è£…æœºç›˜è®¾ç½®ä½å¯åŠ¨é¦–é€‰é¡¹
+ å¯¹äºæ°‘ç”¨çº§ä¸»æ¿ï¼Œä¸€èˆ¬ä¸º`F11` , `F12` æˆ–è€… `Del`
+ å¯¹äºDELLæœåŠ¡å™¨è¿›å…¥`BIOS`çš„è§¦å‘é”®ä½`F2`

### 3. æ’å…¥è£…æœºç›˜ å®‰è£…ç³»ç»Ÿ

+ ä½¿ç”¨éå›¾å½¢åŒ–ç•Œé¢
+ å®‰è£… `ssh server`ä¸éœ€è¦å®‰è£…GUI
+ å®‰è£…è¿‡ç¨‹ä¸éœ€è¦è¿›è¡Œç½‘ç»œé…ç½®
+ å®‰è£…è¿‡ç¨‹ä¸­ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¸¸è§„ç”¨æˆ·
	+ å¦‚æœæ“ä½œçš„æ˜¯NISL Server `root`çš„å¯†ç æ˜¯<p style="filter: blur(10px);">cannot tell you ğŸ˜ˆ</p>
	+ å¦‚æœæ“ä½œçš„æ˜¯NISL Serveræ–°ç”¨æˆ·åä¸º `installer` å¯†ç ä¸º<p style="filter: blur(10px);">  cannot tell you ğŸ˜ˆ </p>
+ ç³»ç»Ÿå®‰è£…åœ¨970 EVOä¸­ï¼Œè‡ªåŠ¨åˆ†åŒºï¼Œå…¶ä»–ç£ç›˜å‡ä¸ºæœªæŒ‚è½½çŠ¶æ€ã€‚
### 4. é…ç½®åŸºæœ¬ç½‘ç»œ

#### 4.1 ç½‘ç»œé…ç½®

è°ƒæ•´ç½‘ç»œé…ç½®Â `/etc/network/interfaces`ï¼Œä½¿å¾—å…¶å½¢å¦‚

```c
auto enp6s0f0
iface enp6s0f0 inet static
    address 10.176.25.53
    netmask 255.255.254.0
    gateway 10.176.24.1
```

- `address`Â æ˜¯é™æ€åœ°å€ï¼Œéœ€è¦æŒ‰ç…§ä¸åŒæœºå™¨è¿›è¡Œåˆ†é…
- `netmask`Â æ˜¯å­ç½‘æ©ç ï¼Œä¸ºÂ `23`Â ä½ï¼Œè¯¥é•¿åº¦å›ºå®šã€‚
- `gateway`Â æ˜¯ç½‘å…³ï¼Œå¯ç”±å­ç½‘æ©ç è®¡ç®—å¾—å‡ºï¼Œå›ºå®šã€‚

é‡å¯ç½‘ç»œæœåŠ¡

```shell
sudo systemctl restart networking.service
```

#### 4.2 æ ¡å›­ç½‘è®¤è¯

+ æŒ‚è½½Uç›˜
+ å°†Uç›˜çš„ç™»å½•è„šæœ¬æ‹·è´
+ ä½¿ç”¨ç™»å½•è„šæœ¬ç™»å½•

### 5. é…ç½®SSH

#### 5.1 ç¦ç”¨å¯†ç ç™»å½•

ä¿®æ”¹ `/etc/ssh/sshd_config`

```shell
#line 57:
PasswordAuthentication no
```

#### 5.2 ç”Ÿæˆç§˜é’¥

> å¦‚æœæ˜¯æ“ä½œ NISL Server åˆ™ä¸º `installer`ç”¨æˆ·ç”Ÿæˆç§˜é’¥

- ç”Ÿæˆç§˜é’¥

```sh
# ç”Ÿæˆç§˜é’¥
ssh-keygen -t rsa -b 4096
```

- å°†å…¬é’¥æ”¹åä¸ºÂ `authorized_keys`

```sh
cd ./.ssh
cat id_rsa.pub >> authorized_keys
rm id_rsa.pub
```

- å°†ç§é’¥æ‹·è´åˆ° U ç›˜ï¼ˆä¸´æ—¶æŒ‚è½½ç‚¹ï¼‰ä¸Šé¢

```sh
cp ./id_rsa ../install_tmp
```

+ **åœ¨è¿™ä¸€æ­¥å®Œæˆåï¼Œå¯ä»¥ç¦»å¼€å®ä½“æœºï¼Œè¿›è¡Œè¿œç¨‹æ“ä½œã€‚**

### 6. ä¿®æ”¹DNSæœåŠ¡å™¨

- ä¿®æ”¹é…ç½®æ–‡ä»¶

```bash
vi /etc/resolv.conf
```

- æ·»åŠ å¦‚ä¸‹å†…å®¹

```sh
# åœ¨åŸå§‹æ–‡ä»¶åŸºç¡€ä¸Šæ·»åŠ 
nameserver 202.120.224.26
nameserver 114.114.114.114
nameserver 8.8.8.8
```

- é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶

```sh
/etc/init.d/networking restart
```

### 7.  apt æ¢æº

+ å°† `/etc/apt/sources.list`ä¸­çš„å†…å®¹æ•´ä½“æ›¿æ¢ä¸º

```sh
# ç»Ÿä¸€é‡‡ç”¨é˜¿é‡Œäº‘é•œåƒ 
deb https://mirrors.aliyun.com/debian/ bookworm main non-free non-free-firmware contrib deb-src https://mirrors.aliyun.com/debian/ bookworm main non-free non-free-firmware contrib deb https://mirrors.aliyun.com/debian-security/ bookworm-security main deb-src https://mirrors.aliyun.com/debian-security/ bookworm-security main deb https://mirrors.aliyun.com/debian/ bookworm-updates main non-free non-free-firmware contrib deb-src https://mirrors.aliyun.com/debian/ bookworm-updates main non-free non-free-firmware contrib deb https://mirrors.aliyun.com/debian/ bookworm-backports main non-free non-free-firmware contrib deb-src https://mirrors.aliyun.com/debian/ bookworm-backports main non-free non-free-firmware contrib
```
+ æ‰§è¡Œå‡çº§å‘½ä»¤

```sh
#root 
apt-get update && apt-get upgrade 
# å®‰è£…å¿…è¦è½¯ä»¶ 
apt-get install tmux zsh vim neofetch git sudo curl rsync duf zip unzip screen fzf fd-find
```

### 8. é…ç½®`sudo`

+ å°†ç¼–è¾‘å™¨ä»`nano`æ”¹ä¸º`vim`

```sh
update-alternatives --config editor
```

+ ç¼–è¾‘`visudo`

### 9. è®¾ç½®æ—¶é’ŸåŒæ­¥

- ç¡¬ä»¶æ—¶é’ŸçŸ«æ­£Â `hwclock`
- è®¾ç½®æ—¶é—´Â `date`Â å’ŒÂ `hwclock`Â åŒæ­¥

```sh
sudo hwclock --systohc
```

+ ä¿®æ”¹æ—¶é—´ä¸º24æ—¶è®¡æ—¶æ³•

```sh
sudo vim /etc/default/locale
```

æ·»åŠ 

```shell
LANG=en_US.UTF-8
LC_TIME=en_US.UTF-8
```

é‡æ–°åŠ è½½å®ˆæŠ¤è¿›ç¨‹

```sh
sudo systemctl daemon-reload 
# æŒ‰ç…§ /etc/fstab é‡æ–°æŒ‚è½½ 
mount -a
```

### 10. æŒ‚è½½é¢å¤–çš„ç£ç›˜

#### data

+ ä½¿ç”¨`parted`ä¸ºå—è®¾å¤‡`nvme0n1`åˆ†åŒº å°†æ•´ä¸ªç£ç›˜åˆ†ä¸ºä¸€ä¸ªä¸»åˆ†åŒº
	+ å°†å¾—åˆ°åˆ†åŒº`nvme0n1p1`
+ ä½¿ç”¨`mkfs`å°†`btrfs`æŒ‚è½½åˆ°`nvme0n1p1`

```shell
sudo mkfs.btrfs /dev/nvme0n1p1
```

+ å°†`nvme0n1p1`æŒ‚è½½åˆ°`/data`æŒ‚è½½ç‚¹

```shell
sudo mount /dev/nvme0n1p1 /data
```

#### hdd

`/hdd`æ˜¯ä¸€ä¸ªRAID0é˜µåˆ—ï¼Œç”¨äºè¿›è¡Œç³»ç»Ÿå¤‡ä»½ã€‚

+ ä½¿ç”¨`parted`ä¸ºå—è®¾å¤‡`sda`å’Œ`sdb`åˆ†åŒº å°†æ•´ä¸ªç£ç›˜åˆ†ä¸ºä¸€ä¸ªä¸»åˆ†åŒº
	+ å°†å¾—åˆ°åˆ†åŒº`sda1`å’Œ`sdb1`
+ ä½¿ç”¨`mdadm`åˆ›å»ºä¸€ä¸ªRAID0é˜µåˆ— 

```shell
sudo mdadm --create --verbose /dev/md0 --level=1 --raid-devices=2 /dev/sda1 /dev/sdb1

```

+ ä¸º`md0`æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ

```shell
sudo mkfs.btrfs /dev/md0
```

+ å°†æ­¤é…ç½®å†™å…¥`/etc/mdadm/mdadm.conf`

```shell
# This configuration was auto-generated on Thu, 23 May 2024 17:54:37 +0800 by mkconf
ARRAY /dev/md0 metadata=1.2 name=nisl-superman:0 UUID=8b0e391f:f36291d9:5acabf5b:8a3fc6d6
```

+ æŒ‚è½½`md0`åˆ°`/hdd`

```shell
sudo mount /dev/md0 /hdd
```

#### ä¿®æ”¹ `fstab`

ä¿®æ”¹åçš„`fstab`

```shell
# <file system> <mount point>   <type>  <options>       <dump>  <pass>
# / was on /dev/nvme1n1p2 during installation
UUID=fb944645-2483-4472-9f6f-0e50f2115044 /               ext4    errors=remount-ro 0       1
# /boot/efi was on /dev/nvme1n1p1 during installation
UUID=6B59-4865  /boot/efi       vfat    umask=0077      0       1
# swap was on /dev/nvme1n1p3 during installation
UUID=08282ecc-b789-40a2-9d03-c235acc8cf2a none            swap    sw              0       0
# /data was on /dev/nvme0n1p1
UUID=b70bda07-3de3-4dce-9506-d4329d5a8697 /data          btrfs    defaults 0       1
# /hdd was on /dev/md0
UUID=07c21af2-8b30-4121-a78f-c06ebdaefb35 /hdd          btrfs    defaults 0       1
```

## å†™åœ¨æœ€å

è‡³æ­¤ï¼Œç½‘ç»œè¿é€šæ€§å’Œç¡¬ä»¶å±‚é¢çš„è®¾ç½®éƒ½å·²ç»å®Œæˆã€‚å¯ä»¥å¼€å§‹ç•…ç©äº†ğŸºğŸºğŸºã€‚
